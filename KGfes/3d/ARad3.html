<!DOCTYPE html>
<!--HTML5-->
<html lang="ja">

<head>
    <!-- meta設定 -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="Content-Script-Type" content="text/javascript" charset="UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/ccs" charset="UTF-8" />
    <meta name="robots" content="noindex,nofollow" />

    <!-- JS/CSS master -->
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
    <script
        src="https://unpkg.com/aframe-particle-system-component@1.1.3/dist/aframe-particle-system-component.min.js"></script>
    <title>五峯祭へお越しください！</title>
</head>

<body>
    <a-scene id="myGallery" stats embedded arjs="debugUIEnabled:false;">
        <!--   <a-scene id="myGallery" stats>-->

        <a-assets>
            <!--
            <a-asset-item id="5mine-obj" src="obj/taitorunomoji.obj"></a-asset-item>
            <a-asset-item id="5mine-mtl" src="obj/taitorunomoji.mtl"></a-asset-item>
            -->
        </a-assets>
        <!--
        -->
        <a-marker preset="hiro">
            <a-sky color="#888" opacity="0.3"></a-sky>
            <a-entity id="imgWrap" animation="property:rotation;to:0 360 0;loop:true;dur:36000;easing:linear;">
            </a-entity>
            <a-entity animation="property:rotation;to:0 360 0;loop:true;dur:12000;easing:linear;">
                <!--
                    <a-obj-model src="#5mine-obj" mtl="#5mine-mtl" position="0 -0.5 1.5" scale=".3 .3 .3" rotation="-30 0 0"></a-obj-model>
                -->
                <a-obj-model src="obj/taitorunomoji.obj" mtl="obj/taitorunomoji.mtl" position="0 0.5 3"
                    scale=".3 .3 .3" rotation="-30 0 0"></a-obj-model>
            </a-entity>
            <a-entity particle-system="preset:star;
                     size:0.5;color: #FFFF00,#FF8800;opacity:1;blending:1;
                     velocityValue:0 0 0;velocitySpread:1 2 1;
                     positionSpread:5 0 5;
                     particleCount:100;" position="0 20 0"></a-entity>


            <a-entity id="z-axis" position="0 0 0"></a-entity>
            <!--
            <a-entity id="z-camera-wrap" position="1 -0.2 4">
                <a-entity id="z-camera" camera look-controls>
                    <a-cursor color="#114" opacity="0.5"></a-cursor>
                </a-entity>
            </a-entity>

    -->

        </a-marker>
        <a-entity camera></a-entity>
    </a-scene>
    <script>
        function setImg() {
            let imgWrap = document.getElementById("imgWrap");
            let r = 2.5;
            let img = [
                "obj/poster0.png",
                "obj/poster1.png",
                "obj/poster2.png",
                "obj/poster3.png",

                "obj/poster0.png",
                "obj/poster1.png",
                "obj/poster2.png",
                "obj/poster3.png",

                "obj/poster0.png",
                "obj/poster1.png",
                "obj/poster2.png",
                "obj/poster3.png"
            ];
            for (var i = 0; i < img.length; i++) {
                let ele = document.createElement("a-image");

                ele.setAttribute("scale", "2 2 2");
                ele.setAttribute("src", img[i]);
                ele.setAttribute("position",
                    r * Math.sin(i / 6 * 2 * Math.PI) + " " +
                    Math.floor(i / 6) * 2.3 + " " +
                    r * Math.cos(i / 6 * 2 * Math.PI)
                );
                ele.setAttribute("rotation", "-30 " + i * 60 + " 0");
                //ele.setAttribute("color", "#0f0");

                ele.setAttribute("side", "double");
                imgWrap.appendChild(ele);
            }
        }
        setImg();

        function reRotation() {
            let fps = getFPS();
            let wrap = document.getElementById("imgWrap");
            let rot = wrap.getAttribute("rotation");

            wrap.setAttribute("rotation", "0 " + (10.0 / fps + rot.y) + " 0");
            if (rot.y >= 360) {
                rot.y -= 360;
            }
            requestAnimationFrame(reRotation);
        }

        //軸表示
        function setAxis(id) {
            document.getElementById(id).innerHTML = "" +
                '<!--Point of Origin-->' +
                '<a-sphere position="0 0 0" radius="0.1" color="#000" wireframe="true"></a-sphere>' +
                '<!-- X-axis -->' +
                '<a-cylinder color="#f00" radius="0.01" rotation="0 0 90" position="0.5 0 0"></a-cylinder>' +
                '<a-cone color="#f00" radius-bottom="0.1" height="0.1" rotation="0 0 -90" position="1 0 0"></a-cone>' +
                '<!-- Y-axis -->' +
                '<a-cylinder color="#0F0" radius="0.01" rotation="0 0 0" position="0 0.5 0"></a-cylinder>' +
                '<a-cone color="#0f0" radius-bottom="0.1" height="0.1" rotation="0 0 0" position="0 1 0"></a-cone>' +
                '<!-- Z-axis -->' +
                '<a-cylinder color="#00f" radius="0.01" rotation="90 0 0" position="0 0 0.5"></a-cylinder>' +
                '<a-cone color="#00f" radius-bottom="0.1" height="0.1" rotation="90 0 0" position="0 0 1"></a-cone>' +
                '<!-- unit box -->' +
                '<a-box color="#000" wireframe="true"></a-box>';
        }

        // FPS処理
        let z_Aframe_fps_oldtime = new Date();
        function getFPS() {
            //前回描画時からのmsec差分を取得
            let fps_newtime = new Date();
            let d = fps_newtime.getTime() - z_Aframe_fps_oldtime.getTime();
            z_Aframe_fps_oldtime = fps_newtime;
            // FPS = 1000 / d
            return 1000 / d;
        }

        window.addEventListener('load', (event) => {
            //デバッグ用：軸表示
            setAxis("z-axis");

            //reRotation();
        });

    </script>

</body>

</html>